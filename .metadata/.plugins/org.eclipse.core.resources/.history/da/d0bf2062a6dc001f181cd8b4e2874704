package tascaS103Ex3;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Random;
import java.util.Scanner;

public class GeographyGame {
	private static HashMap<String, String> countryCapitals = new HashMap();
	   private static final int TOTAL_QUESTIONS = 10;

	   public GeographyGame() {
	   }

	   public static void main(String[] var0) {
	      loadCountries();
	      playGame();
	   }

	   private static void loadCountries() {
	      try {
	         BufferedReader var0 = new BufferedReader(new FileReader("countries.txt"));

	         String var1;
	         try {
	            while((var1 = var0.readLine()) != null) {
	               String[] var2 = var1.split(",");
	               if (var2.length == 2) {
	                  countryCapitals.put(var2[0].trim(), var2[1].trim());
	               }
	            }
	         } catch (Throwable var4) {
	            try {
	               var0.close();
	            } catch (Throwable var3) {
	               var4.addSuppressed(var3);
	            }

	            throw var4;
	         }

	         var0.close();
	      } catch (IOException var5) {
	         System.out.println("Error reading countries file: " + var5.getMessage());
	         System.exit(1);
	      }

	   }

	   private static void playGame() {
	      Scanner var0 = new Scanner(System.in);
	      System.out.print("Please enter your name: ");
	      String var1 = var0.nextLine();
	      ArrayList var2 = new ArrayList(countryCapitals.keySet());
	      Random var3 = new Random();
	      int var4 = 0;
	      HashSet var5 = new HashSet();

	      for(int var6 = 0; var6 < 10 && var2.size() > var5.size(); ++var6) {
	         String var7;
	         do {
	            var7 = (String)var2.get(var3.nextInt(var2.size()));
	         } while(var5.contains(var7));

	         var5.add(var7);
	         System.out.printf("\nWhat is the capital of %s? ", var7);
	         String var8 = var0.nextLine().trim();
	         String var9 = (String)countryCapitals.get(var7);
	         if (var8.equalsIgnoreCase(var9)) {
	            System.out.println("Correct!");
	            ++var4;
	         } else {
	            System.out.printf("Wrong! The capital of %s is %s\n", var7, var9);
	         }
	      }

	      System.out.printf("\nGame Over! Your score: %d out of %d\n", var4, 10);
	      saveScore(var1, var4);
	   }

	   private static void saveScore(String var0, int var1) {
	      try {
	         FileWriter var2 = new FileWriter("classificacio.txt", true);

	         try {
	            BufferedWriter var3 = new BufferedWriter(var2);

	            try {
	               var3.write(String.format("%s: %d points%n", var0, var1));
	               System.out.println("Score saved successfully!");
	            } catch (Throwable var8) {
	               try {
	                  var3.close();
	               } catch (Throwable var7) {
	                  var8.addSuppressed(var7);
	               }

	               throw var8;
	            }

	            var3.close();
	         } catch (Throwable var9) {
	            try {
	               var2.close();
	            } catch (Throwable var6) {
	               var9.addSuppressed(var6);
	            }

	            throw var9;
	         }

	         var2.close();
	      } catch (IOException var10) {
	         System.out.println("Error saving score: " + var10.getMessage());
	      }

	   }
	}
